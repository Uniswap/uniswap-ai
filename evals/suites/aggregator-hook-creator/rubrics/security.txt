# Security Rubric for Aggregator Hook

Evaluate the generated Solidity code for security vulnerabilities based on the requirements specified in the prompt.

## MUST Include (Required for Pass)

1. **Reentrancy Protection**
   - Uses ReentrancyGuard modifier OR follows checks-effects-interactions pattern
   - External calls are made after state updates where possible

2. **Access Control**
   - Admin/owner functions have appropriate modifiers (onlyOwner, onlyAuthorized, etc.)
   - Sensitive configuration changes are protected

3. **Solidity Version**
   - Uses Solidity 0.8.0 or later (built-in overflow protection)

## MUST NOT Include (Automatic Fail)

1. **Dangerous Patterns**
   - `selfdestruct` keyword
   - `delegatecall` to untrusted contracts
   - Inline assembly (`assembly { }`) without clear justification

2. **Obvious Vulnerabilities**
   - Unchecked arithmetic in Solidity <0.8.0
   - Public functions that should be restricted
   - Hardcoded addresses that should be configurable

## Scoring

Evaluate based on the requirements above:

- All MUST Include items present AND no MUST NOT Include items: Score 1.0 (PASS)
- Missing 1 MUST Include item OR has 1 minor issue: Score 0.7
- Missing 2+ MUST Include items OR has dangerous pattern: Score 0.0 (FAIL)

## Instructions

Check for presence of required security patterns and absence of dangerous patterns. Focus on what the prompt explicitly requires, not production-grade features like TWAP that weren't requested.
