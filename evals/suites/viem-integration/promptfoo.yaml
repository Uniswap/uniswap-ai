# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json
description: 'viem-integration Skill Evaluation'

# Prompt template that injects skill context + case content via vars
prompts:
  - file://prompt-wrapper.txt

# Provider configuration
providers:
  - id: anthropic:claude-sonnet-4-5-20250929
    config:
      temperature: 0
      max_tokens: 8192

# Default test configuration applied to all tests
defaultTest:
  options:
    timeout: 120000 # 2 minutes per case
  vars:
    skill_content: file://../../../packages/plugins/uniswap-viem/skills/viem-integration/SKILL.md

# Test cases with specific assertions
tests:
  - vars:
      case_content: file://cases/basic.md
    assert:
      # Correctness rubric
      - type: llm-rubric
        value: file://rubrics/correctness.txt
        threshold: 0.8
        provider: anthropic:claude-sonnet-4-5-20250929

      # Completeness rubric
      - type: llm-rubric
        value: file://rubrics/completeness.txt
        threshold: 0.85
        provider: anthropic:claude-sonnet-4-5-20250929

      # Deterministic checks for required patterns
      - type: contains
        value: 'createPublicClient'
      - type: contains
        value: 'viem'

  - vars:
      case_content: file://cases/wagmi-react.md
    assert:
      # Wagmi-specific correctness rubric (evaluates React hooks, not raw viem)
      - type: llm-rubric
        value: file://rubrics/wagmi-correctness.txt
        threshold: 0.8
        provider: anthropic:claude-sonnet-4-5-20250929

      # Wagmi-specific completeness rubric
      - type: llm-rubric
        value: file://rubrics/wagmi-completeness.txt
        threshold: 0.85
        provider: anthropic:claude-sonnet-4-5-20250929

      # Deterministic checks for wagmi-specific patterns
      - type: contains
        value: 'WagmiProvider'
      - type: contains
        value: 'createConfig'
      - type: contains
        value: 'useAccount'
      - type: contains
        value: 'useConnect'
      - type: contains
        value: 'QueryClientProvider'
      - type: contains
        value: 'wagmi'

      # Should not contain common mistakes
      - type: not-contains
        value: 'ethers'
