# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json
description: 'Swap Planner Skill Evaluation'

# Prompts (eval cases)
prompts:
  - id: file://cases/basic-swap.md
    label: basic-swap
  - id: file://cases/token-discovery.md
    label: token-discovery
  - id: file://cases/cross-chain-swap.md
    label: cross-chain-swap

# Provider configuration
providers:
  - id: anthropic:claude-sonnet-4-5-20250929
    config:
      temperature: 0
      max_tokens: 4096

# Default test configuration applied to all tests
defaultTest:
  options:
    timeout: 120000 # 2 minutes per case

# Test cases with specific assertions
tests:
  # Test 1: Basic Token Swap Planning
  - prompts: ['basic-swap']
    vars:
      scenario: basic-swap
    assert:
      - type: llm-rubric
        value: file://rubrics/swap-correctness.txt
        threshold: 0.7
        provider: anthropic:claude-sonnet-4-5-20250929

      # Must reference Uniswap
      - type: contains-any
        value:
          - 'app.uniswap.org'
          - 'uniswap.org'
          - 'Uniswap'
          - 'uniswap'
      # Must reference token verification or addresses
      - type: contains-any
        value:
          - 'dexscreener'
          - 'DexScreener'
          - 'verify'
          - 'contract'
          - 'address'
          - '0x'

  # Test 2: Token Discovery Workflow
  - prompts: ['token-discovery']
    vars:
      scenario: token-discovery
    assert:
      - type: llm-rubric
        value: file://rubrics/discovery-completeness.txt
        threshold: 0.65
        provider: anthropic:claude-sonnet-4-5-20250929

      # Must reference data sources
      - type: contains-any
        value:
          - 'dexscreener'
          - 'DexScreener'
          - 'DEX'
          - 'trending'
          - 'search'
      # Must show token details
      - type: contains-any
        value:
          - 'liquidity'
          - 'volume'
          - 'price'
          - 'market cap'

  # Test 3: Cross-Chain Swap
  - prompts: ['cross-chain-swap']
    vars:
      scenario: cross-chain-swap
    assert:
      - type: llm-rubric
        value: file://rubrics/swap-correctness.txt
        threshold: 0.7
        provider: anthropic:claude-sonnet-4-5-20250929

      # Must include chain specification
      - type: contains-any
        value:
          - 'chain'
          - 'Base'
          - 'Arbitrum'
          - 'Polygon'
          - 'Optimism'
      # Must reference Uniswap
      - type: contains-any
        value:
          - 'app.uniswap.org'
          - 'uniswap.org'
          - 'Uniswap'
          - 'uniswap'
